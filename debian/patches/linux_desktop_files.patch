Description: install linux .desktop and hicolor icons
This patch is hardcoded for linux, do not upstream.
Author: Feignint <37488595+FeignInt@users.noreply.github.com>
Last-Update: 2020-09-02
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/configure.ac
+++ b/configure.ac
@@ -692,5 +692,7 @@ src/platform/Makefile
 src/platform/visualc/Makefile
 include/Makefile
 docs/Makefile
+contrib/Makefile
+contrib/linux/Makefile
 ])
 AC_OUTPUT
--- /dev/null
+++ b/contrib/linux/Makefile.am
@@ -0,0 +1,12 @@
+desktopdir = $(datadir)/applications
+desktop_DATA = dosbox-staging.desktop
+iconsdir = $(datadir)/icons
+nobase_dist_icons_DATA = hicolor/*/*/dosbox-staging.*
+
+hicolor/%:
+	$(MAKE) -C $(top_srcdir)/contrib/icons hicolor
+	ln -s $(top_srcdir)/contrib/icons/hicolor .
+
+clean-am:
+	rm hicolor
+	$(MAKE) -C $(top_srcdir)/contrib/icons clean
--- /dev/null
+++ b/contrib/Makefile.am
@@ -0,0 +1 @@
+SUBDIRS = linux
--- a/Makefile.am
+++ b/Makefile.am
@@ -4,7 +4,7 @@ AM_MAKEFLAGS ?= --no-print-directory
 
 EXTRA_DIST = autogen.sh
 
-SUBDIRS = docs include src
+SUBDIRS = docs include src contrib
 
 # Per the auto-tools clean guidelines:
 # https://www.gnu.org/savannah-checkouts/gnu/automake/manual/html_node/Clean.html#Clean
